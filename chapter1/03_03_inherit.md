# 继承、优先级和层叠

## 继承

CSS 的某些样式是具有继承性的，那么什么是继承性呢？从字面上也很好理解这个性质，即子标签的继承属性，如果没有指定值时，会默认取其上级标签的同属性值。来看一个例子：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>继承</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
    p { color: red; }
    </style>
</head>
<body>
    <p>子标签 <strong>继承</strong> 了上级标签的 CSS 样式属性</p>
</body>
</html>
```

![](/assets/css-inherit.png)

在上例中，我们只给 `p` 元素设置了字体颜色，但是从浏览器显示结果可以看出，其子标签 `strong` 同样也显示了红色，即子标签继承了父标签的 `color` 属性。

在 [w3c 这里](https://www.w3.org/TR/CSS22/propidx.html)有列出 CSS2.2 属性是否可继承。

## 优先级

我们知道，一个元素的样式可以通过多种方式来定义， 那么最终是什么决定了元素显示在浏览器中的样式呢？CSS 优先级会决定 CSS 样式在浏览器中被解析的先后顺序。

CSS优先级规则

样式表中的特殊性描述了不同规则的相对权重，这些权重决定了优先级，它的基本规则是：

* 继承权值为0.1（忽略不计）

* 标签的权值为1

* 类选择器的权值为10

* ID 选择器的权值为100


权值越高，优先级越高。例如：

```
p { color: #999; } /* 权值：1 */
p strong { color: #333; } /* 权值：1 + 1 = 2 */
#stress{ color: red; } /* 权值：100 */
#stress i.italic{ color: pink; } /* 权值：100 + 1 + 10 = 111 */
```

假设有一段文字，它的 HTML 结构为：

```
<p>浏览器根据<strong>优先级</strong>解析 <strong id="stress"><i class="italic">CSS</i> 样式属性</strong></p>
```

那么根据上面的样式定义，最终浏览器解析后，应该呈现为：

![](/assets/css-priority.png)

## 层叠

优先级决定了浏览器的解析，那么，如果权重值相同的情况下，浏览器又将如何解析呢？CSS 层叠性能帮我们解决这个问题。

层叠性是指，当有相同权重的样式存在时，CSS 会根据这些css样式的前后顺序来决定，处于最后面的css样式会被应用。

对于层叠来说，共有三种主要的样式来源：

* 浏览器对HTML定义的默认样式。

* 用户定义的样式。

* 开发者定义的样式，可以有三种形式：

  * 外联样式（定义在外部文件里的样式）

  * 内联样式（定义在页面头部）：通过这种形式定义的样式只在本页面内生效。


  * 行内样式（定义在特定的元素身上）：这种形式多用于测试，可维护性较差，无特殊情况，不建议使用。



用户定义的样式表会覆盖浏览器定义的默认样式，然后网页开发者定义的样式又会覆盖用户样式。网页开发者定义的行内样式优先级最高，会覆盖外联样式和内联样式。而外联样式和内联样式则根据定义的先后顺序来决定优先级。同一种样式来源，则同属性的样式也是根据定义的先后顺序来决定最终显示哪个样式的。

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>层叠</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        p { color: pink; }
        p { color: #999; }
    </style>
</head>
<body>
    <p>层叠性是指，当有相同权重的样式存在时，CSS 会根据这些css样式的前后顺序来决定，处于最后面的css样式会被应用。</p>
</body>
</html>
```

上例中，外联样式表中有定义 `p` 元素的颜色为黑色，在内联样式中，同时又定义了两次 `p` 元素的颜色值。根据上面层叠的定义，最终 `p` 元素应该是显示灰色的。

![](/assets/css-stack.png)

当然，如果在 `p` 元素上假如我们还用 `style` 属性定义了其他颜色（行内样式），那么最终的显示颜色将根据这个值来显示。

